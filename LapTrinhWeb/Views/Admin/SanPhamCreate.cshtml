@model tblSanPham

@{
    ViewBag.Title = "Thêm mới sản phẩm";
    Layout = "~/Views/Shared/_Layout.cshtml";
}

<div class="card shadow mb-4">
    <div class="card-header py-3">
        <h6 class="m-0 font-weight-bold text-primary">Thêm mới sản phẩm</h6>
    </div>
    <div class="card-body">
        @using (Html.BeginForm("SanPhamCreate", "Admin", FormMethod.Post, new { enctype = "multipart/form-data" })) // Lưu ý enctype nếu bạn định upload ảnh thật sau này
        {
            @Html.AntiForgeryToken()
            <div class="form-horizontal">
                @Html.ValidationSummary(true, "", new { @class = "text-danger" })

                <div class="row">
                    <div class="col-md-6">
                        <h5 class="text-gray-800 mb-3">Thông tin chung</h5>

                        <div class="form-group">
                            <label>Tên sản phẩm <span class="text-danger">*</span></label>
                            @Html.EditorFor(model => model.TenSP, new { htmlAttributes = new { @class = "form-control", required = "required" } })
                            @Html.ValidationMessageFor(model => model.TenSP, "", new { @class = "text-danger" })
                        </div>

                        <div class="form-group">
                            <label>Loại sản phẩm <span class="text-danger">*</span></label>
                            <select class="form-control" id="LoaiSanPham" name="LoaiSanPham" onchange="togglePetFields()">
                                <option value="Accessory">Phụ kiện / Thức ăn</option>
                                <option value="Pet">Thú cưng (Pet)</option>
                            </select>
                            @Html.ValidationMessageFor(model => model.LoaiSanPham, "", new { @class = "text-danger" })
                        </div>

                        <div class="form-group">
                            <label>Danh mục</label>
                            @Html.DropDownList("MaDanhMuc", null, htmlAttributes: new { @class = "form-control" })
                        </div>

                        <div class="form-group">
                            <label>Nhà cung cấp</label>
                            @Html.DropDownList("MaNCC", null, htmlAttributes: new { @class = "form-control" })
                        </div>

                        <div class="form-group">
                            <label>Giá bán (VNĐ)</label>
                            @Html.EditorFor(model => model.GiaBan, new { htmlAttributes = new { @class = "form-control", type = "number" } })
                            @Html.ValidationMessageFor(model => model.GiaBan, "", new { @class = "text-danger" })
                        </div>

                        <div class="form-group">
                            <label>Ảnh đại diện (Tên file)</label>
                            @Html.EditorFor(model => model.AnhDaiDien, new { htmlAttributes = new { @class = "form-control", placeholder = "VD: poodle.jpg" } })
                            @Html.ValidationMessageFor(model => model.AnhDaiDien, "", new { @class = "text-danger" })
                        </div>

                        <div class="form-group">
                            <label>Mô tả chi tiết</label>
                            @Html.TextAreaFor(model => model.MoTa, new { @class = "form-control", rows = 4 })
                        </div>
                    </div>

                    <div class="col-md-6" id="pet-fields" style="display:none; background-color: #f8f9fc; padding: 15px; border-radius: 8px;">
                        <h5 class="text-info mb-3"><i class="fas fa-paw"></i> Thông tin Thú cưng</h5>

                        <div class="form-group">
                            <label>Giới tính</label>
                            @Html.DropDownListFor(model => model.GioiTinh, new List<SelectListItem> {
                                new SelectListItem { Text = "Đực", Value = "Đực" },
                                new SelectListItem { Text = "Cái", Value = "Cái" }
                            }, "--- Chọn giới tính ---", new { @class = "form-control" })
                        </div>

                        <div class="form-group">
                            <label>Ngày sinh</label>
                            @Html.EditorFor(model => model.NgaySinh, new { htmlAttributes = new { @class = "form-control", type = "date" } })
                        </div>

                        <div class="form-group">
                            <label>Màu sắc</label>
                            @Html.EditorFor(model => model.MauSac, new { htmlAttributes = new { @class = "form-control" } })
                        </div>

                        <div class="form-group">
                            <label>Tình trạng sức khỏe</label>
                            @Html.EditorFor(model => model.TinhTrangSucKhoe, new { htmlAttributes = new { @class = "form-control" } })
                        </div>

                        <div class="form-group">
                            <label>Tiền sử bệnh (nếu có)</label>
                            @Html.TextAreaFor(model => model.TienSuBenh, new { @class = "form-control", rows = 2 })
                        </div>
                    </div>
                </div>

                <div class="form-group mt-3 text-center">
                    <input type="submit" value="Thêm mới" class="btn btn-primary px-5" />
                    <a href="@Url.Action("SanPham")" class="btn btn-secondary">Quay lại</a>
                </div>
            </div>
        }
    </div>
</div>

@section Scripts {
    <script>
        function togglePetFields() {
            var type = $('#LoaiSanPham').val();
            if (type === 'Pet') {
                $('#pet-fields').slideDown();
            } else {
                $('#pet-fields').slideUp();
            }
        }

        $(document).ready(function () {
            togglePetFields();
        });
    </script>
}